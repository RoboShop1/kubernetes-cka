apiVersion: v1
kind: Pod
metadata:
  name: init-pod
spec:
  volumes:
    - name: vol
      hostPath:
        path: /tmp/vol
  containers:
    - name: nginx
      image: nginx
      volumeMounts:
        - name: vol
          mountPath: /usr/share/nginx/html/
  initContainers:
    - name: init1
      image: alpine
      command: ["sh","-c"]
      env:
        - name: c_name
          valueFrom:
            fieldRef:
              fieldPath: spec.containers[0].name
        - name: pod_ip
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
      args:
        - 'while true; do echo "This is ${c_name} - ${pod_ip}" > /data/index.html; sleep 15; done'
      volumeMounts:
        - name: vol
          mountPath: /data
    - name: init2
      image: alpine
      command: [ "sh","-c" ]
      env:
        - name: c_name
          valueFrom:
            fieldRef:
              fieldPath: spec.containers[1].name
        - name: pod_ip
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
      args:
        - 'while true; do echo "This is ${c_name} - ${pod_ip}" >> /data/index.html; sleep 15; done'
      volumeMounts:
        - name: vol
          mountPath: /data